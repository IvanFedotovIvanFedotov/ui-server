@import "../../../components/icon-button/mixins";
@import "../../../components/slider/mixins";
@import "../../../components/animation/functions";
@import "../../../components/theme/mixins";
@import "./keyframes";
@import "./variables";
@import "./mixins";

.player {
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #000;
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
    z-index: 0;
    outline: 0;
    touch-action: manipulation;

    &--theater-mode {
        height: calc((9 / 16) * 100vw);
        max-height: calc(100vh - 169px);
        min-height: 480px;
        position: relative;
    }

    &--big-mode {
        // For Safari 5.1
        // https://developer.mozilla.org/en-US/docs/Web/Apps/Fundamentals/Audio_and_video_delivery/cross_browser_video_player
        video::-webkit-media-controls {
            display:none !important;
        }
        .player-controls {
            z-index:2147483647;
        }

        .player-controls__action {
            width: 54px;
            height: 54px;
            padding: 9px;
            svg {
                height: 100%;
                width: 100%;
            }
        }
    }
}

.player__state-overlay {
    @include player-state-overlay-size_($player-state-overlay-size);
    position: absolute;
    left: 50%;
    top: 50%;
    z-index: 5;
    background: rgba(0, 0 , 0, .5);
    animation: player-state-overlay-fadeout .5s linear normal forwards;
    pointer-events: none;
}

.player__state-overlay-icon {
    @include player-state-overlay-icon-size_($player-state-overlay-icon-size);
    @include mdc-theme-prop(color, $player-controls-color);
}

.player--big-mode .player__state-overlay {
    @include player-state-overlay-size_($player-state-overlay-size-big);
}

.player--big-mode .player__state-overlay-icon {
    @include player-state-overlay-icon-size_($player-state-overlay-icon-size-big);
}

.player__overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 1em;
    height: 1em;
    opacity: 0.75;
}

.player__video {
    max-width: 100%;
    min-height: 100%;
    display: block;
    position: absolute;
    z-index: -1;
}

.player__audio {
    display: none;
}

.player-controls-gradient {
    width: 100%;
    position: absolute;
    bottom: 0;
    z-index: 2;
    padding-top: 54px;
    height: 54px;

    background-repeat: repeat-x;
    background-position: bottom;
    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==);
}

.player-controls {
    height: 54px;
    line-height: 54px;
    position: absolute;
    bottom: 0;
    z-index: 3;
    width: 100%;
    display: flex;
    flex-direction: row;

    &__section {
        padding: 3px 0;
        display: inline-flex;
        flex: 1 1 auto;
        align-items: center;
        min-width: 0;
        z-index: 1;

        &--align-start {
            padding-left: 3px;
            justify-content: flex-start;
            order: -1;
        }

        &--align-end {
            padding-right: 3px;
            justify-content: flex-end;
            order: 1;
        }
    }

    &__volume-panel {
        margin-right: 6px;
        display: inline-flex;
        align-items: center;
        overflow: hidden;
        &:hover .player-controls__volume,
        &:active .player-controls__volume,
        & .player-controls__volume:focus,
        & .player-controls__volume:active,
        & .player-controls__action--mute:hover ~ .player-controls__volume {
            width: 52px;
            margin-right: 3px;
            transition: mdc-animation-enter(margin, $player-animation-duration),
                        mdc-animation-enter(width, $player-animation-duration);
        }
    }

    &__volume {
        @include mdc-slider-color-accessible($player-controls-color);
        width: 0;
        transition: mdc-animation-exit-permanent(margin, $player-animation-duration),
                    mdc-animation-exit-permanent(width, $player-animation-duration);
        .mdc-slider__container {
            padding: 22px 6px;
        }
        .mdc-slider__track {
            height: 3px;
        }
        .mdc-slider__focus-ring {
            display: none;
        }
    }

    &__action {
        @include mdc-icon-button-ink-color($player-controls-color);
        &:before, &:after {
            display: none;
        }
        &:disabled {
            @include mdc-icon-button-ink-color($player-controls-color);
            opacity: .5;
        }
        width: 36px;
        height: 36px;
        padding: 6px;
        opacity: 0.9;

        &--fullscreen {
            display: none;
        }
        &--mute {
            margin-right: 3px;
        }
    }
}
